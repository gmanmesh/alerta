<!DOCTYPE html>
<html>
<head>
  <title>Email Verification</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/supabase.min.js"></script>
</head>
<body>
  <h1>Verifying your email...</h1>
  <script>
    // Initialize Supabase client
    const supabaseUrl = 'https://lxsqhmqmzuaryxgwuius.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx4c3FobXFtenVhcnl4Z3d1aXVzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk1NTQwODgsImV4cCI6MjA2NTEzMDA4OH0.iuvTDWf7vlkPUddyix-qN9w8QnB-wkVjfBZ0ATTBdW8'; 
    const supabase = supabase.createClient(supabaseUrl, supabaseKey);

    // Parse URL parameters
    const params = new URLSearchParams(window.location.search);
    const token = params.get('token');
    const type = params.get('type');

    // Function to verify email
    async function verifyEmail() {
      if (token && type === 'signup') {
        const { user, error } = await supabase.auth.getUser();
        if (user) {
          window.location.href = '192.168.100.29:8081://verification-success?status=verified';
        } else {
          // Not verified or error
          window.location.href = '192.168.100.29:8081://verification-failed?status=failed';
        }
      } else {
        // No token or wrong type
        window.location.href = 'myapp://verification-failed?status=failed';
      }
    }
    verifyEmail();
  </script>
</body>
</html>
